# CXTB-155 Complete Follow-up Ticket for Participant - Participant Pane
TestCarePartnerCompleteFollowUpTicketForParticipantPane:
  Environment: Settings 
  Precases:
    - CarePartnerCleanCallQueueAndHangedCalls
  Roles:
    - Role: desktopChrome
      App: desktop
  Actions:
  # Calling Login case
    - Type: case
      Value: CarePartnerLogin
  # Create Follow-up
  # Generate unique name for the follow up ticket.
    - Type: generate_unique_name
      Name: "FollowUp Ticket"
      ResultVar: FOLLOW_UP_TICKET
  # Generate a Follow Up Ticket.
    - Type: case
      Value: CarePartnerCreateFollowUpTicket
  #Select participant to whom you created the recent follow up
  # Navigate to Participants.
    - Type: case
      Value: CarePartnerNavigateToParticipants
  # Decrease listing by searching participant's name
    - Type: search_by_text
      Role: desktopChrome
      Text: $AND_CLI_senior_user1_name$
  # Click on the corresponding participant.
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_participant.senior_complete_name$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_participant.call_portal_btn$
  #Click on the follow up tab in the Participant's Details
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_participant_records.follow_up_tickets_tab$
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_participant_records.follow_up_tickets_tab$
  #Wait for ticket
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_participant_records_follow_up_tickets.follow_up_ticket_name$
  #Click to expand a ticket.
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_participant_records_follow_up_tickets.follow_up_ticket_name$
  #Complete
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_participant_details.completed_follow_up_ticket_button$
    - Type: click_js
      Strategy: xpath
      Id: $PAGE.care_platform_participant_details.completed_follow_up_ticket_button$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_participant_details.follow_up_ticket_modal_time_to_complete$
    - Type: send_keys
      Strategy: xpath
      Id: $PAGE.care_platform_participant_details.follow_up_ticket_modal_time_to_complete$
      Value: 1
  #Save and Archive
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_participant_details.save_and_archive_button$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_notifications.follow_up_ticket_completed_notification$
    - Type: wait_not_visible
      Strategy: xpath
      Id: $PAGE.care_platform_notifications.follow_up_ticket_completed_notification$
  #Check Archive
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_participant_records_follow_up_tickets.archived_tickets_button$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_participant_records_follow_up_tickets.follow_up_ticket_name$
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_participant_records_follow_up_tickets.follow_up_ticket_name$
  #Expands and shows creation information, and additional details about the task that was completed.
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_participant_records_follow_up_tickets.expanded_ticket_content$
    - Type: get_attribute
      Strategy: xpath
      Id: $PAGE.care_platform_participant_records_follow_up_tickets.expanded_ticket_content$
      Greps:
        - var: COMPLETED_LABEL_VALUE
          attr: textContent
          condition: nempty
          match: "(.*)"
  #Getting today's date
    - Type: get_timestamp
      Format: "%m/%d/%Y"
      Var: TODAYS_DATE
    - Type: assert
      Asserts:
        - Type: contain
          Var: COMPLETED_LABEL_VALUE
          Value: Completed $AND_CLI_TODAYS_DATE$