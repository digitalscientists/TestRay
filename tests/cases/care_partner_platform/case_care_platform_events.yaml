# CXTB-131: Call Portal View - Create Event for Participant.
TestCarePartnerCreateEventForParticipant:
  Environment: Settings
  # Precases:
  #   - LoginNeverAloneHelper
  #   - CarePartnerCleanCallQueueAndHangedCalls
  #   - SeniorCleanPrompts
  # Aftercases:
  #   - TerminateApp
  Roles:
    - Role: desktopChrome
      App: desktop 
  Actions:
  # Calling Login case.
    - Type: case
      Value: CarePartnerLogin
  # Navigate to Participants.
    - Type: case
      Value: CarePartnerNavigateToParticipants
  # Click on the corresponding participant.
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_participant.senior_complete_name$
  # Click on the "Call Portal" button.
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_participant.call_portal_btn$
  # Page updates to show portal screen with "No active call" text in video window.
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.video_status$
    - Type: get_attribute
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.video_status$
      Greps:
        - var: CALL_MESSAGE
          attr: textContent
          condition: nempty
          match: "(.*)"
    - Type: assert
      Asserts:
        - Type: eq
          Var: CALL_MESSAGE
          Value: 'No active call.'
  # Click "Create event" button by Events label.
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.create_event_btn$    
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.create_event_btn$   
  # New "Create event" modal appears to left of section with fields needed to create an event.
    - Type: wait_for
      Strategy: xpath
      Role: desktopChrome
      Id: $PAGE.care_platform_create_event_modal.modal_title$
    - Type: wait_for_property
      Strategy: xpath
      Id: $PAGE.care_platform_create_event_modal.modal_title$ 
      Property: textContent
      Value: "Create Event"
    # send keys to subject
    - Type: send_keys
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.subject_input$
      Value: Automation Text
  # Click the "Cancel" button if you’ve started in error or if you change your mind (before or after making any changes).
    - Type: click
      Strategy: xpath
      Role: desktopChrome
      Id: $PAGE.care_platform_create_event_modal.cancel_button$
    - Type: wait_not_visible
      Strategy: xpath
      Role: desktopChrome
      Id: $PAGE.care_platform_create_event_modal.modal_title$
  # Click "Create event" button by Events label.
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.create_event_btn$   
  # New "Create event" modal appears to left of section with fields needed to create an event.
    - Type: wait_for
      Strategy: xpath
      Role: desktopChromeß
      Id: $PAGE.care_platform_create_event_modal.modal_title$
    - Type: wait_for_property
      Strategy: xpath
      Id: $PAGE.care_platform_create_event_modal.modal_title$ 
      Property: textContent
      Value: "Create Event"
  # No information will be pushed to the participant’s schedule, so will not be visible in the Care Platform nor on the participant’s device.
    - Type: wait_for_property
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.subject_input$
      Property: textContent
      Value: ""
  # Select the Telehealth appointment Category for the event.
  # Verify that the location should automatically update to show "Virtual appointment".
  # Select the Manual appointment Category for the event.
  # Verify that the location field remains open for you to type in information.

    