#CXTB-214: Validating Home elements
TestHomePage:
  Environment: Settings 
  Roles:
    - Role: desktopChrome
      Capabilities:
        chromeOptions:
          args:
            - use-fake-ui-for-media-stream
            - use-fake-device-for-media-stream
            - no-sandbox
            - disable-gpu
      App: "desktop"
  Actions:
  #Calling Login case
    - Type: case
      Value: CarePartnerLogin
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform.page_title$
      Condition:
      - Value: 2
        Operation: visible
        Result: true
  #Checking Home page and navigation
    - Type: get_text
      Strategy: xpath
      Id : $PAGE.care_platform.page_title$
      Greps:
        - var: HOME_TITLE
          match: "Call Queue"
    - Type: assert
      Role: desktopChrome
      Asserts:
        - Type: eq
          Var: HOME_TITLE
          Value: "Call Queue"
    - Type: click
      Strategy: xpath
      Id : $PAGE.care_platform.navigation_participant$
    - Type: get_text
      Strategy: xpath
      Id : $PAGE.care_platform.page_title$
      Greps:
        - var: HOME_TITLE
          match: "Participants"
      Asserts:
        - Type: eq
          Var: HOME_TITLE
          Value: "Participants"
    - Type: click
      Strategy: xpath
      Id : $PAGE.care_platform.navigation_followup$
    - Type: get_text
      Strategy: xpath
      Id : $PAGE.care_platform.page_title$
      Greps:
        - var: HOME_TITLE
          match: "Follow-up*"
      Asserts:
        - Type: eq
          Var: HOME_TITLE
          Value: "Follow-up Tickets"
  #Checking Header elements
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_header.app_logo$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_header.app_time$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_header.user_toggle_input$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_header.user_dropdown_button$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_header.headset_icon$
  #Checking options in the user drop-down
    - Type: click
      Strategy: xpath
      Id : $PAGE.care_platform_header.user_dropdown_button$
    - Type: wait_for
      Strategy: xpath
  #Status
      Id: $PAGE.care_platform_header.status_menu_header$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_header.status_available_button$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_header.status_away_button$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_header.status_insession_button$
    - Type: wait_for
      Strategy: xpath
  #Other options
      Id: $PAGE.care_platform_header.account_menu_header$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_header.help_menu_button$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_header.myaccount_menu_button$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_header.logout_menu_button$

#CXTB-223: Validating changes of status (Not in Call)
TestStatusDropdown_NotInCall:
  Environment: Settings 
  Roles:
    - Role: desktopChrome
      Capabilities:
        chromeOptions:
          args:
            - use-fake-ui-for-media-stream
            - use-fake-device-for-media-stream
            - no-sandbox
            - disable-gpu
      App: "desktop"
  Actions:
  #Calling Login case
    - Type: case
      Value: CarePartnerLogin
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform.page_title$
      Condition:
      - Value: 2
        Operation: visible
        Result: true
  #Status
    - Type: click
      Strategy: xpath
      Id : $PAGE.care_platform_header.user_dropdown_button$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_header.status_menu_header$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_header.status_available_button$
  #Changing status to away
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_header.status_away_button$
  #Navigating to participants page
    - Type: click
      Strategy: xpath
      Id : $PAGE.care_platform.navigation_participant$
    - Type: get_text
      Strategy: xpath
      Id : $PAGE.care_platform.page_title$
      Greps:
        - var: HOME_TITLE
          match: "Participants"
      Asserts:
        - Type: eq
          Var: HOME_TITLE
          Value: "Participants"
  #Checking indicator is set to Away status
    - Type: get_attribute
      Strategy: xpath
      Id: $PAGE.care_platform_header.status_indicator$
      Greps:
        - var: STATUS_VAR
          attr: class
          condition: nempty
          match: "(.*)has-status(.*)"
    - Type: assert
      Asserts:
        - Type: contain
          Var: STATUS_VAR
          Value: "is-empty"
  #Trying to change status to In Session (shouldn't let you do it manually)
    - Type: click
      Strategy: xpath
      Id : $PAGE.care_platform_header.user_dropdown_button$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_header.status_insession_button$
    - Type: click_js
      Strategy: xpath
      Id: $PAGE.care_platform_header.status_insession_button$
    - Type: click
      Strategy: xpath
      Id : $PAGE.care_platform.navigation_followup$
  #Verifying the status indicator didn't change to In Session
    - Type: get_attribute
      Strategy: xpath
      Id: $PAGE.care_platform_header.status_indicator$
      Greps:
        - var: STATUS_VAR
          attr: class
          condition: nempty
          match: "(.*)has-status(.*)"
    - Type: assert
      Asserts:
        - Type: contain
          Var: STATUS_VAR
          Value: "is-empty"
  #Changing status back to available
    - Type: click
      Strategy: xpath
      Id : $PAGE.care_platform_header.user_dropdown_button$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_header.status_menu_header$
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_header.status_available_button$
    - Type: click
      Strategy: xpath
      Id : $PAGE.care_platform.navigation_followup$
    - Type: get_text
      Strategy: xpath
      Id : $PAGE.care_platform.page_title$
      Greps:
        - var: HOME_TITLE
          match: "Follow-up*"
      Asserts:
        - Type: eq
          Var: HOME_TITLE
          Value: "Follow-up Tickets"
  #Checking the status indicator correspond to Available
    - Type: get_attribute
      Strategy: xpath
      Id: $PAGE.care_platform_header.status_indicator$
      Greps:
        - var: STATUS_VAR
          attr: class
          condition: nempty
          match: "(.*)has-status(.*)"
    - Type: assert
      Asserts:
        - Type: contain
          Var: STATUS_VAR
          Value: "is-green"

#CXTB-227 Account - Update info
TestUpdateInfoAccount:
  Environment: Settings 
  Roles:
    - Role: desktopChrome
      Capabilities:
        chromeOptions:
          args:
            - use-fake-ui-for-media-stream
            - use-fake-device-for-media-stream
            - no-sandbox
            - disable-gpu
      App: "desktop"
  Actions:
  #Calling Login case
    - Type: case
      Value: CarePartnerLogin
  #Going to My Account
    - Type: click
      Strategy: xpath
      Id : $PAGE.care_platform_header.user_dropdown_button$
    - Type: click
      Strategy: xpath
      Id : $PAGE.care_platform_header.myaccount_menu_button$  
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.myaccount_info.modal_title$
  #Saving original firstname, and adding a 1 to form input
    - Type: get_attribute
      Strategy: xpath
      Id : $PAGE.myaccount_info.firstname_input$
      Greps:
        - var: FIRSTNAME_ORIG
          attr: value
          condition: nempty
          match: "(.*)"
    - Type: send_keys
      Strategy: xpath
      Id: $PAGE.myaccount_info.firstname_input$
      Value: '1'
    - Type: click
      Strategy: xpath
      Id : $PAGE.myaccount_info.modal_title$
    - Type: get_attribute
      Strategy: xpath
      Id : $PAGE.myaccount_info.firstname_input$
      Greps:
        - var: FIRSTNAME_NEW
          attr: value
          condition: nempty
          match: "(.*)" 
  #Checking original and new name are not the same
    - Type: assert
      Asserts:
        - Type: ne
          Var: FIRSTNAME_ORIG
          Value: $AND_CLI_FIRSTNAME_NEW$
  #Verify that the email input can't be modify
    - Type: wait_for_attribute
      Strategy: xpath
      Id: $PAGE.myaccount_info.email_input$
      Attribute: disabled
      Value: true
    - Type: click
      Strategy: xpath
      Id : $PAGE.myaccount_info.save_changes_button$  
  #Wait for the success alert message
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.myaccount_info.success_alert_msg$
    - Type: wait_not_visible
      Strategy: xpath
      Id: $PAGE.myaccount_info.success_alert_msg$
      Time: 10
  #Verify that the name in the header reflects the new change to the firstname
    - Type: get_text
      Strategy: xpath
      Id : $PAGE.care_platform_header.dropdown_username$
      Greps:
        - var: NEW_NAME
          condition: nempty
          match: "(.*)"
    - Type: assert
      Asserts:
        - Type: contain
          Var: NEW_NAME
          Value: $AND_CLI_FIRSTNAME_NEW$
  #Going again to the My Account Modal
    - Type: click
      Strategy: xpath
      Id : $PAGE.care_platform_header.user_dropdown_button$
    - Type: click
      Strategy: xpath
      Id : $PAGE.care_platform_header.myaccount_menu_button$  
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.myaccount_info.modal_title$
  #Changing back the first name as it was originally
    - Type: send_keys
      Strategy: xpath
      Id: $PAGE.myaccount_info.firstname_input$
      Value: "backspace"
    - Type: click
      Strategy: xpath
      Id : $PAGE.myaccount_info.save_changes_button$
    - Type: wait_not_visible
      Strategy: xpath
      Id: $PAGE.myaccount_info.success_alert_msg$
      Time: 10
    - Type: click
      Strategy: xpath
      Id : $PAGE.care_platform_header.user_dropdown_button$
    - Type: click
      Strategy: xpath
      Id : $PAGE.care_platform_header.myaccount_menu_button$
    - Type: get_attribute
      Strategy: xpath
      Id : $PAGE.myaccount_info.firstname_input$
      Greps:
        - var: BACK_NAME
          attr: value
          condition: nempty
          match: "(.*)"
    - Type: assert
      Asserts:
        - Type: eq
          Var: BACK_NAME
          Value: $AND_CLI_FIRSTNAME_ORIG$
  #Check error on phone number
    - Type: send_keys
      Strategy: xpath
      Id: $PAGE.myaccount_info.phone_input$
      Value: "backspace"
    - Type: click
      Strategy: xpath
      Id : $PAGE.myaccount_info.save_changes_button$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.myaccount_info.phone_error_message$
  #Use button cancel of the modal
    - Type: click
      Strategy: xpath
      Id : $PAGE.myaccount_info.cancel_button$
    - Type: wait_not_visible
      Strategy: xpath
      Id: $PAGE.myaccount_info.modal_title$
      Time: 2
