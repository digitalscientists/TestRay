# CTBX-162- Click and View Facility Device Record From Listing
TestOnboarderClickAndViewFacilitiesDevice:
    Environment: Settings
    Roles:
    - Role: desktopChrome
      App: "desktop"
    Actions:
    # login in onboarder Care Partner
    - Type: case
      Value: OnboarderCarePartnerLogin 
    # click in facilities button 
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_facility.facilities_button$
    # click on the first listing record
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_participant.first_senior_lastname$
    # click on Overview button and verify if tab showing belongs to Overview
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_facility.overview_button$
    - Type: get_attribute
      Strategy: xpath
      Id: $PAGE.care_platform_facility.tabs_content$
      Greps:
      - var: TAB_CLASS
        attr: tab-title
        condition: nempty
        match: "(.*)"
    - Type: assert
      Asserts:
      - Type: contain
        Var: TAB_CLASS
        Value: 'Overview'
    # click on Local Hospitals button and verify if tab showing belongs to Local Hospitals
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_facility.local_hospitals_button$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_facility.title_subtab_local_hospital$
    - Type: get_attribute
      Strategy: xpath
      Id: $PAGE.care_platform_facility.tabs_content$
      Greps:
      - var: TAB_CLASS
        attr: tab-title
        condition: nempty
        match: "(.*)"
    - Type: assert
      Asserts:
      - Type: contain
        Var: TAB_CLASS
        Value: 'Local Hospitals'
    # click on Devices button and verify if tab showeing belogs to Devices
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_facility.devices_button$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_facility.title_subtab_devices$
    - Type: get_attribute
      Strategy: xpath
      Id: $PAGE.care_platform_facility.tabs_content$
      Greps:
      - var: TAB_CLASS
        attr: tab-title
        condition: nempty
        match: "(.*)"
    - Type: assert
      Asserts:
      - Type: contain
        Var: TAB_CLASS
        Value: 'Devices'
    # Click on record button and check the Overview Tab
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_participant_details.records_button$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_facility_Record.info_title$
    # Click on Devices button to see the facility device list
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_facility_Record.devices_button$
    - Type: get_attribute
      Strategy: xpath
      Id: $PAGE.care_platform_facility_Record.device_status$
      Greps:
      - var: STATUS_CLASS
        attr: class
        condition: nempty
        match: "(.*)"
    - Type: assert
      Asserts:
      - Type: contain
        Var: STATUS_CLASS 
        Value: 'active'

# CXTB-161-Access Facilities Directory & Filter
TestOnboardersAccessFacilitiesDirectoryFilter:
   Environment: Settings
   Roles: 
   - Role: desktopChrome
     App: "desktop"
   Actions:
  # log in with my onboarder user
   - Type: case
     Value: OnboarderCarePartnerLogin
  # Click on the facilites button
   - Type: click
     Strategy: xpath
     Id: $PAGE.care_platform_facility.facilities_button$
  # Get the value to compare later
   - Type: get_text
     Strategy: xpath
     Id: $PAGE.care_platform_participant.first_darkened_letter_button$
     Greps:
        - var: FILTER_LETTER
          match: "(.*)"
  # Click the first darkened letter button
   - Type: click
     Strategy: xpath
     Id: $PAGE.care_platform_participant.first_darkened_letter_button$
  #Verify it was filtered by the selected letter
   - Type: get_text
     Strategy: xpath
     Id: $PAGE.care_platform_participant.first_senior_lastname$
     Greps:
        - var: FIRST_LETTER
          match: ^[a-zA-Z]   #The match selects: The first char from the starter word (^) that is a letter ([a-zA-Z])
   - Type: assert
     Asserts: 
     - Type: eq
       Var: FIRST_LETTER
       Value: $AND_CLI_FILTER_LETTER$
  #Remove the filter by letter
   - Type: click
     Strategy: xpath
     Id: $PAGE.care_platform_participant.selected_darkened_letter_button$
  #Get the first lastname in the list
   - Type: get_text
     Strategy: xpath
     Id: $PAGE.care_platform_participant.first_senior_lastname$
     Greps:
        - var: FIRST_facility_NO_FILTER
          match: (.*)
  #Add the search filter
   - Type: click
     Strategy: id
     Id: $PAGE.care_platform_facility.search_button$
   - Type: send_keys
     Strategy: id
     Id: $PAGE.care_platform_facility.search_text$
     Value: $AND_CLI_FIRST_facility_NO_FILTER$
  #Verify there is at least 1 user with that name
   - Type: wait_for
     Strategy: xpath
     Id: $PAGE.care_platform_participant.first_senior_lastname$
   - Type: get_text
     Strategy: xpath
     Id: $PAGE.care_platform_participant.first_senior_lastname$
     Greps:
        - var: FIRST_FACILITY
          match: (.*)
  #Verify the first participant lastname contains the text filtered
   - Type: assert
     Asserts: 
      - Type: contain
        Var: FIRST_FACILITY
        Value: $AND_CLI_FIRST_facility_NO_FILTER$
  #Clear the search by clicking small "x" at right of field
   - Type: click
     Strategy: xpath
     Id: $PAGE.care_platform_participant.clear_search_button$
  #Verify there is at least 1 user
   - Type: wait_for
     Strategy: xpath
     Id: $PAGE.care_platform_participant.first_senior_lastname$
  #Click on an user
   - Type: click
     Strategy: xpath
     Id: $PAGE.care_platform_participant.senior_1_row$
   - Type : wait_for
     Strategy: xpath
     Id: $PAGE.care_platform_facility.facility_name$
     