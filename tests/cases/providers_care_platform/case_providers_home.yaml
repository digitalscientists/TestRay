# CXTB-118 Providers Care Platform - Homepage Listing View
TestProviderHomePageListingView:
  Environment: Settings
  Vars:
    LOGOUT_OPTION: "Go Off Shift"  
  Precases:
    - ProviderNewCleaner
  Aftercases:
    - TerminateApp
  Roles:
    - Role: desktopChrome
      App: desktop
    - Role: localiOS
      Capabilities:
        newCommandTimeout: 120
      App: NeverAlone
  Actions:
      # Setup for the test data
      #Call login for nurses
    - Type: case
      Role: localiOS
      Value: LoginSNFHelper
      #Calling Prompt cleaner
    - Type: case
      Role: localiOS
      Value: SeniorCleanPrompts
      #Missed call 
    - Type: case
      Value: SetMissedCallFromSNF
      #Clean any prompt notification from the start
    - Type: case
      Role: localiOS
      Value: SeniorCleanPrompts
      #Login as Provider
    - Type: case
      Value: ProvidersCarePlatformLogin
      #Follow-up ticket
    - Type: case
      Value: CreateAFollowUpForSNFCall
      #Making sure that the provider is logged out
    - Type: case
      Value: CarePlatformLogout
      #Scheduled call from Employee
      #Opening new tab for the employee's part of the process
    - Type: new_tab
    - Type: switch_window
      Value: 1
    - Type: case
      Value: SetScheduledCallTicketFromEmployee
      #Switch back to providers tab
    - Type: switch_window
      Value: 0
      #Login again
    - Type: case
      Value: ProvidersCarePlatformLogin
      #Checking there's no call or session open right now
    - Type: case
      Value: ProviderEndCurrentCall
      #Navigating to Home
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform.navigation_home$
      #Set Time to All
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_home_page.time_dropdown$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.providers_home_page.time_all_option$
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_home_page.time_all_option$
      Condition:
        - Value: 5
          Operation: visible
          Result: true
      #Check the different calls on the queue
      # Verify Missed calls are present
    - Type: get_text  
      Strategy: xpath
      Id: $PAGE.providers_home_page.missed_call$
      Greps:
      - var: missed_call_text
        match: "(.*)"
    - Type: assert
      Asserts: 
      - Type: contain
        Var: missed_call_text
        Value: "Missed Call"
        raise: true
      # Verify Scheduled calls are present
    - Type: get_text
      Strategy: xpath
      Id: $PAGE.providers_home_page.scheduled_call$
      Greps:
      - var: scheduled_call_text
        match: "(.*)"
    - Type: assert
      Asserts: 
      - Type: contain
        Var: scheduled_call_text
        Value: "Scheduled Call"
        raise: true
      # Verify Follow-up calls are present
    - Type: get_text  
      Strategy: xpath
      Id: $PAGE.providers_home_page.follow_up_calls$
      Greps:
      - var: follow_up_text
        match: "(.*)"
    - Type: assert
      Asserts: 
      - Type: contain
        Var: follow_up_text
        Value: "Follow-up"
        raise: true

# CXTB-104 Provider's Status - Not on Active Call
TestProviderStatusNotOnActiveCall:
  Environment: Settings
  Precases:
    - ProviderNewCleaner
  Roles:
    - Role: desktopChrome
      App: desktop
  Actions:
      # Login to the Care Platform app with Providers account
    - Type: case
      Value: ProvidersCarePlatformLogin
      # Status should be available after login
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_header.status_indicator$
    - Type: get_attribute
      Strategy: xpath
      Id: $PAGE.care_platform_header.status_indicator$
      Greps:
        - var: STATUS_VAR
          attr: class
          condition: nempty
          match: "(.*)has-status(.*)"
    - Type: assert
      Asserts:
        - Type: contain
          Var: STATUS_VAR
          Value: "is-green"
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_header.user_dropdown_button$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.providers_user_dropdown_menu.user_status_available$
      #Shift status "ON SHIFT"
    - Type: get_text
      Strategy: xpath
      Id: $PAGE.providers_user_dropdown_menu.user_shift_toggle_label$
      Greps:
        - var: SHIFT_VAR
          condition: nempty
          match: "(.*)"
    - Type: assert
      Asserts:
        - Type: contain
          Var: SHIFT_VAR
          Value: "On"
      #Change shift status to off
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_user_dropdown_menu.user_shift_toggle_checkbox$
    - Type: sleep
      Time: 2
    - Type: get_text
      Strategy: xpath
      Id: $PAGE.providers_user_dropdown_menu.user_shift_toggle_label$
      Greps:
        - var: SHIFT_VAR
          condition: nempty
          match: "(.*)"
    - Type: assert
      Asserts:
        - Type: contain
          Var: SHIFT_VAR
          Value: "Off"
      #Change back to available
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_user_dropdown_menu.user_shift_toggle_checkbox$
    - Type: sleep
      Time: 2
      #Log out and stay on shift, to check if the status is Idle
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_home_page.home_button$
      # Calling Logout case.
    - Type: set_env_var
      Value: "Stay On Shift"
      Var: LOGOUT_OPTION
    - Type: case
      Value: CarePlatformLogout
      # Log in with the second user.
    - Type: case
      Value: ProviderLoginSecondaryUser
    # Click on the users dropdown.
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_header.headset_dropdown_button$
    # Verify that the first user has stayed on shift, and Idle
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.providers_user_dropdown_menu.user_list_item_provider1$
    - Type: get_attribute
      Strategy: xpath
      Id: $PAGE.providers_user_dropdown_menu.user_list_item_provider1$
      Greps:
        - var: STATUS_PROVIDER1
          attr: innerHTML
          condition: nempty
          match: "(.*)"
    - Type: assert
      Asserts:
        - Type: contain
          Var: STATUS_PROVIDER1
          Value: "Idle"

# Physical Device only.
# CXTB-133: Verify that Providers answer SNF call and completes session.
TestProvidersAnswerSNFCallAndCompletesSession:
  Environment: Settings
  Vars:
    PROVIDERS_SUBJECT:  Automation Test Call SNF.
    PROVIDERS_DETAILS:  Automation Test Notes Verify that Providers answer SNF call and completes session.
  Precases:
    - ProviderNewCleaner
    - LoginSNFHelper
  Aftercases:
    - TerminateApp
    - ProviderEndCurrentCall
  Roles:
    - Role: desktopChrome
      App: desktop
    - Role: localiOS
      App: NeverAlone
  Actions:
    # Login to the Care Platform app with Providers account.
    - Type: case
      Value: ProvidersCarePlatformLogin
    #Calling Prompt cleaner
    - Type: case
      Role: localiOS
      Value: SeniorCleanPrompts
    # Call Provider from SNF.
    - Type: case
      Value: SNFNewRequestHelper
    # Click on the corresponding call on the Home page to and click on the "Answer" button.
    - Type: wait_for
      Strategy: xpath
      Id : $PAGE.providers_home_page.on_demand_based_on_participant_name$
    - Type: click
      Strategy: xpath
      Id : $PAGE.providers_home_page.on_demand_based_on_participant_name$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.answer_call_button$
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.answer_call_button$
    # Call portal should be displayed and the user status has been automatically updated to "In session" (red dot).
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.video_btn$
    - Type: get_attribute
      Strategy: xpath
      Id: $PAGE.care_platform_header.status_indicator$
      Greps:
        - var: INDICATOR
          attr: class
          condition: nempty
          match: "(.*)"
    - Type: assert
      Asserts:
        - Type: contain
          Var: INDICATOR
          Value: 'is-red'
    # Verify video is disabled by default on the Providers.
    - Type: get_attribute
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.call_camera_button$
      Greps:
        - var: CLASS
          attr: innerHTML
          condition: nempty
          match: "(.*)"
    - Type: assert
      Asserts:
        - Type: contain
          Var: CLASS
          Value: 'off'
  # Verify video is disabled by default on the SNF.
    - Type: wait_not_visible
      Role: localiOS
      Strategy: class_chain
      Id: $PAGE.seniors_app_call.video_window$
    # Click the "End Call" button.
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.end_call_btn$
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.end_call_btn$
    # Video area updates to show a message showing that the call has ended.
    - Type: get_attribute
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.video_status$
      Greps:
        - var: CALL_MESSAGE
          attr: textContent
          condition: nempty
          match: "(.*)"
    - Type: assert
      Asserts:
        - Type: contain
          Var: CALL_MESSAGE
          Value: 'The call has ended'
    # Verify that the status still is "In Session".
    - Type: get_attribute
      Strategy: xpath
      Id: $PAGE.care_platform_header.status_indicator$
      Greps:
        - var: INDICATOR
          attr: class
          condition: nempty
          match: "(.*)"
    - Type: assert
      Asserts:
        - Type: contain
          Var: INDICATOR
          Value: 'is-red'
    # Fill the Provider's call notes
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.call_notes_subject_input$
    - Type: send_keys
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.call_notes_subject_input$
      Value: $AND_CLI_PROVIDERS_SUBJECT$
    - Type: send_keys
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.call_notes_provider_input$
      Value: $AND_CLI_PROVIDERS_DETAILS$
    # Click the "Complete session" button.
    - Type: wait_for_property
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.complete_session_button$ 
      Property: disabled
      Value: "false"
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.complete_session_button$ 
    # Post-call survey screen appears with your current notes pre-populated.
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.post_call_survey_title$
    - Type: return_element_attribute
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.call_notes_subject_input$
      Attribute: value
      ResultVar: SUBJECT_SUBJECT_CURRENT_TEXT
    - Type: assert
      Asserts:
        - Type: eq
          Var: SUBJECT_SUBJECT_CURRENT_TEXT
          Value: $AND_CLI_PROVIDERS_SUBJECT$
    - Type: return_element_attribute
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.call_notes_provider_input$
      Attribute: value
      ResultVar: SUBJECT_NOTES_CURRENT_TEXT
    - Type: assert
      Asserts:
        - Type: eq
          Var: SUBJECT_NOTES_CURRENT_TEXT
          Value: $AND_CLI_PROVIDERS_DETAILS$
    # Change to "No" on the "Was issue resolved" question.
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.resolved_no_option$
    # Survey updates based on this response:
    # New "Reason" field appears.
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.reason_label$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.reason_input$
    # "Follow-up recommended" is automatically selected.
    - Type: wait_for_attribute
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.follow_up_recommended_checkbox$
      Attribute: value
      Value: true
    # New time options appear below Follow-up recommended checkbox, with "1 hour" selected.
    - Type: wait_for_attribute
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.selected_follow_up_time_option$
      Attribute: value
      Value: "1"
    # "Assign to myself" box appears and is automatically selected.
    - Type: wait_for_attribute
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.assign_to_myself_checkbox$
      Attribute: value
      Value: true
    # Select a reason and click on the "Submit and Exit Session" button.
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.reason_input$
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.first_reason_option$
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.recommend_discharge_no_option$
    - Type: scroll_to
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.submit_exit_session_button$
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.submit_exit_session_button$
    # User is redirected to the Home Listing page with the new Follow-up ticket included in the listing.
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.providers_home_page.home_title$
    # Set Time to all so the follow-up appears.
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_home_page.time_dropdown$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.providers_home_page.time_all_option$
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_home_page.time_all_option$
      Condition:
        - Value: 5
          Operation: visible
          Result: true
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.providers_home_page.follow_up_ticket_based_on_participant_name$
    # Close ticket so it cleans the Home queue.
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_home_page.follow_up_ticket_based_on_participant_name$
    - Type: sleep
      Time: 5
    - Type: wait_for
      Strategy: xpath
      Role: desktopChrome
      Id: $PAGE.providers_follow_up_call_details_page.update_status_dropdown$
    - Type: click
      Strategy: xpath
      Role: desktopChrome
      Id: $PAGE.providers_follow_up_call_details_page.update_status_dropdown$
    - Type: wait_for
      Strategy: xpath
      Role: desktopChrome
      Id: $PAGE.providers_follow_up_call_details_page.status_option_close_ticket$
    - Type: click
      Strategy: xpath
      Role: desktopChrome
      Id: $PAGE.providers_follow_up_call_details_page.status_option_close_ticket$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.providers_home_page.reason_for_closing_ticket_input$
    - Type: send_keys
      Strategy: xpath
      Id: $PAGE.providers_home_page.reason_for_closing_ticket_input$
      Value: 'Automation Test Close Ticket'
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_home_page.save_and_close_ticket_button$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.providers_notifications.follow_up_ticket_closed_notification$

#CTB-205 User Manual Available through "help" Menu Option  
TestProviderHelpMenuOption:
  Environment: Settings
  Roles:
    - Role: desktopChrome
      App: "desktop"
  Actions:
  # Log in with my provider User 
    - Type: case
      Value: ProvidersCarePlatformLogin
  # Click your name in upper Right corner after click on help option
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_home_page.dropdown_username$
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_home_page.button_help$
  #Verify the Help page is visible
    - Type: switch_window
      Value: 1
      CheckTime: 10
    - Type: get_url
      Greps:
      - var: HELP_PAGE_URL
        match: provider_user_manual(.*).pdf
    - Type: assert
      Role: desktopChrome
      Asserts:
        - Type: contain
          Var: HELP_PAGE_URL
          Value: provider_user_manual
        - Type: contain
          Var: HELP_PAGE_URL
          Value: .pdf

# CXTB-125: Providers - Seniors - Return to Call Portal & Complete the Session
TestProvidersReturnToCallPortalAndAndCompletesSession:
  Environment: Settings
  Vars:
    PROVIDERS_SUBJECT:  Automation Test Call Senior.
    PROVIDERS_DETAILS:  Automation Test Notes Verify that Providers answer Senior call and completes session.
  Precases:
    - LoginNeverAloneHelper
    - CarePartnerCleanCallQueueAndHangedCalls
    - SeniorCleanPrompts
    - ProviderNewCleaner
  Aftercases:
    - TerminateApp
  Roles:
    - Role: desktopChrome
      App: desktop
    - Role: localiOS
      App: NeverAlone
    - Role: desktopChrome1
      App: desktop
  Actions:
    # Generate a medical call as a senior.
    - Type: case
      Value: CallCarePartner
  # Login and answer call as a care partner,
    - Type: case
      Value: AnswerCallAsCarePartner
  # Panel slides to the left, bringing you to the Call portal with the active call represented in the call video, and your user status has been automatically updated to "In session" (red dot). 
  # Both cameras default to off as they do currently.
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.end_call_button$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_header.status_indicator$
    - Type: return_element_attribute
      Strategy: xpath
      Id: $PAGE.care_platform_header.status_indicator$
      Attribute: className
      ResultVar: IS_RED
    - Type: assert
      Asserts:
        - Type: contain
          Var: IS_RED
          Value: is-red
  # Verify video is disabled by default on the care partners.
    - Type: get_attribute
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.call_camera_button$
      Greps:
        - var: CLASS
          attr: innerHTML
          condition: nempty
          match: "(.*)"
    - Type: assert
      Asserts:
        - Type: contain
          Var: CLASS
          Value: 'off'
  # Verify video is disabled by default on the seniors.
    - Type: wait_not_visible
      Role: localiOS
      Strategy: class_chain
      Id: $PAGE.seniors_app_call.video_window$
  # Click "Medical" button in video call window so the participant speaks to a doctor while on the call.
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.medical_transfer_btn$
  # "Telehealth request form" appears to the left of video call window.
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.telehealth_request_form_header$
  # Click on "Submit" and verify that the form can't be submitted.
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.submit_btn$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.urgent_patient_matter_error_label$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.reason_for_request_error_label$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.symptoms_start_input_error_label$
  # Fill in the required fields:
  # Priority level, Reason for request and When did symptoms start?
  # Urgent patient matter
    - Type: click
      Strategy: id
      Id: $PAGE.care_platform_call_portal.urgent_patient_matter_select$
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.urgent_patient_matter_yes_option$
  # Reason for request
    - Type: click
      Strategy: id
      Id: $PAGE.care_platform_call_portal.reason_for_request_select$
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.first_reason_for_request_available_option$
  # When did symptoms start      
    - Type: click
      Strategy: class
      Id: $PAGE.care_platform_call_portal.symptoms_start_input_container$
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.today_date_date_picker$
  # Click on "Submit".
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.submit_btn$
  # Telehealth request form window disappears.
    - Type: wait_not_visible
      Strategy: xpath
      Id : $PAGE.care_platform_call_portal.telehealth_request_form_header$
  # Verify "End Call" button has been replaced with "Leave Call" button.
    - Type: wait_for
      Strategy: xpath
      Id : $PAGE.care_platform_call_portal.leave_call_btn$
  # Log in as a provider and join the call
    - Type: case
      Value: ProvidersCarePlatformLogin
      Role: desktopChrome1
    - Type: case
      Value: JoinMedicalTransfer
      Role: desktopChrome1
  # Care partner leaves the call after provider has joined.
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.leave_call_btn$
  # Verify that the video updates to show the "The call has ended" text.
    - Type: get_attribute
      Strategy: xpath
      Id: $PAGE.care_platform_call_portal.video_status$
      Greps:
        - var: CALL_MESSAGE
          attr: textContent
          condition: nempty
          match: "(.*)"
    - Type: assert
      Asserts:
        - Type: contain
          Var: CALL_MESSAGE
          Value: 'The call has ended.'
  # Fill up the post call survey to complete the session.
    - Type: case
      Value: PostCallSurveyCarePartner
  # Verify that care partner was returned to the "Call queue" page.
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform.call_queue_title$
  # Verify that care partner is no longer showing as "In Session (red dot)".
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.care_platform_header.status_indicator$
    - Type: return_element_attribute
      Strategy: xpath
      Id: $PAGE.care_platform_header.status_indicator$
      Attribute: className
      ResultVar: IS_RED
    - Type: assert
      Asserts:
        - Type: n_contain
          Var: IS_RED
          Value: is-red
  # Provider and senior tear down.
  # Provider ends call.
    - Type: click
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.end_call_btn$
  # Provider fills up Post call Survey.
  # Fill the Provider's call notes
    - Type: wait_for
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.call_notes_subject_input$
    - Type: send_keys
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.call_notes_subject_input$
      Value: $AND_CLI_PROVIDERS_SUBJECT$
    - Type: send_keys
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.call_notes_provider_input$
      Value: $AND_CLI_PROVIDERS_DETAILS$
    # Click the "Complete session" button.
    - Type: wait_for_property
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.complete_session_button$ 
      Property: disabled
      Value: "false"
    - Type: click
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.complete_session_button$ 
    # Post-call survey screen appears with your current notes pre-populated.
    - Type: wait_for
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.post_call_survey_title$
    - Type: return_element_attribute
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.call_notes_subject_input$
      Attribute: value
      ResultVar: SUBJECT_SUBJECT_CURRENT_TEXT
    - Type: assert
      Asserts:
        - Type: eq
          Var: SUBJECT_SUBJECT_CURRENT_TEXT
          Value: $AND_CLI_PROVIDERS_SUBJECT$
    - Type: return_element_attribute
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.call_notes_provider_input$
      Attribute: value
      ResultVar: SUBJECT_NOTES_CURRENT_TEXT
    - Type: assert
      Asserts:
        - Type: eq
          Var: SUBJECT_NOTES_CURRENT_TEXT
          Value: $AND_CLI_PROVIDERS_DETAILS$
    # Change to "No" on the "Was issue resolved" question.
    - Type: click
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.resolved_no_option$
    # Survey updates based on this response:
    # New "Reason" field appears.
    - Type: wait_for
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.reason_label$
    - Type: wait_for
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.reason_input$
    # "Follow-up recommended" is automatically selected.
    - Type: wait_for_attribute
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.follow_up_recommended_checkbox$
      Attribute: value
      Value: true
    # New time options appear below Follow-up recommended checkbox, with "1 hour" selected.
    - Type: wait_for_attribute
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.selected_follow_up_time_option$
      Attribute: value
      Value: "1"
    # "Assign to myself" box appears and is automatically selected.
    - Type: wait_for_attribute
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.assign_to_myself_checkbox$
      Attribute: value
      Value: true
    # Select a reason and click on the "Submit and Exit Session" button.
    - Type: click
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.reason_input$
    - Type: click
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.first_reason_option$
    - Type: click
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.recommend_discharge_no_option$
    - Type: scroll_to
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.submit_exit_session_button$
    - Type: click
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_call_handling_page.submit_exit_session_button$
    # User is redirected to the Home Listing page with the new Follow-up ticket included in the listing.
    - Type: wait_for
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_home_page.home_title$
    # Set Time to all so the follow-up appears.
    - Type: click
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_home_page.time_dropdown$
    - Type: wait_for
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_home_page.time_all_option$
    - Type: click
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_home_page.time_all_option$
      Condition:
        - Value: 5
          Operation: visible
          Result: true
    - Type: wait_for
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_home_page.follow_up_ticket_based_on_participant_name$
    # Close ticket so it cleans the Home queue.
    - Type: click
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_home_page.follow_up_ticket_based_on_participant_name$
    - Type: sleep
      Time: 5
    - Type: wait_for
      Strategy: xpath
      Role: desktopChrome1
      Id: $PAGE.providers_follow_up_call_details_page.update_status_dropdown$
    - Type: click
      Strategy: xpath
      Role: desktopChrome1
      Id: $PAGE.providers_follow_up_call_details_page.update_status_dropdown$
    - Type: wait_for
      Strategy: xpath
      Role: desktopChrome1
      Id: $PAGE.providers_follow_up_call_details_page.status_option_close_ticket$
    - Type: click
      Strategy: xpath
      Role: desktopChrome1
      Id: $PAGE.providers_follow_up_call_details_page.status_option_close_ticket$
    - Type: wait_for
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_home_page.reason_for_closing_ticket_input$
    - Type: send_keys
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_home_page.reason_for_closing_ticket_input$
      Value: 'Automation Test Close Ticket'
    - Type: click
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_home_page.save_and_close_ticket_button$
    - Type: wait_for
      Role: desktopChrome1
      Strategy: xpath
      Id: $PAGE.providers_notifications.follow_up_ticket_closed_notification$
  # Senior fills up Post call Survey.
    - Type: case
      Value: SeniorGreatPostSurveyCallHelper