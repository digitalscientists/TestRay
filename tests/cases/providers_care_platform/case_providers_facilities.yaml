
# CXTB-185 Provider Can Click and View Facility Device Record from Listing
TestProviderCanClickAndViewFacilitiesDevice:
  Environment: Settings
  Vars:
    DEVICE_STATUS: "(Active|Pre-delivery|Suspended|Deactivated)"
  Roles:
    - Role: desktopChrome
      App: "desktop"
  Actions:
    # Login-in provider Care Partner
    - Type: case
      Value: ProvidersCarePlatformLogin
    # Click facilities button
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_facilities_page.facilities_button$
    # click on the first listing record
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_facilities_page.facility_based_on_name$
    # Click on Overview button and verify if tab showing belongs to Overview
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_facilities_page.overview_button$
    - Type: get_attribute
      Strategy: xpath
      Id: $PAGE.providers_facilities_page.tabs_content$
      Greps:
      - var: TAB_CLASS
        attr: tab-title
        condition: nempty
        match: "(.*)"
    - Type: assert
      Asserts:
      - Type: contain
        Var: TAB_CLASS
        Value: 'Overview'
    # Click on Local Hospital button and verify if tab showing belongs to Local Hospital
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_facilities_page.local_hospitals_button$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.providers_facilities_page.title_subtab_local_hospital$
    - Type: get_attribute
      Strategy: xpath
      Id: $PAGE.providers_facilities_page.tabs_content$
      Greps:
      - var: TAB_TITLE
        attr: tab-title
        condition: nempty
        match: "(.*)"
    - Type: assert
      Asserts:
        - Type: contain
          Var: TAB_TITLE
          Value: 'Local Hospitals'
    # Click on Devices button and verify if tab showing belongs to Devices
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_facilities_page.devices_tab$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.providers_facilities_page.title_subtab_devices$
    - Type: get_attribute
      Strategy: xpath
      Id: $PAGE.providers_facilities_page.tabs_content$
      Greps:
        - var: TAB_TITLE
          attr: tab-title
          condition: nempty
          match: "(.*)"
    - Type: assert
      Asserts:
        - Type: contain
          Var: TAB_TITLE
          Value: 'Devices'
    # Click on Record button and check the Devices
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_participant_details.records_button$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.providers_facilities_records_page.info_title$
    # Click to check Devices Tab
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_facilities_records_page.devices_tab$
    - Type: sleep
      Time: 2
    - Type: get_text
      Strategy: xpath
      Id: $PAGE.providers_facilities_records_page.device_status$
      Greps:
        - var: STATUS_TEXT
          condition: nempty
          match: "(Active|Pre-delivery|Suspended|Deactivated)"
    - Type: assert
      Asserts:
        - Type: contain
          Var: DEVICE_STATUS
          Value: $AND_CLI_STATUS_TEXT$

# CXTB-186-Can-Click-and-View-Facility-Device-Call-History-and-Access-Call-Recordings
TestProviderCanClickAndViewFacilitiesDeviceCallHistoryAndAccessCallRecordings:
  Environment: Settings
  Roles:
    - Role: desktopChrome
      App: "desktop"
    - Role: localiOS
      App: NeverAlone
  Actions:
    # Login-in provider Care Partner
    - Type: case
      Value: ProvidersCarePlatformLogin
    # Log-in to App for Facilities   
    - Type: case
      Role: localiOS
      Value: LoginSNFHelper
    # Log Call from Facility to Provider 
    - Type: case
      Role: localiOS
      Value: SNFNewRequestHelper
    # End Call from Facility to Provider 
    - Type: case
      Role: desktopChrome
      Value: ProvidersCarePlatformEndCall
    # Click facilities button
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_home_page.facilities_navigation$
    # click on the first listing record
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_facilities_page.alpha_center_td$
    # Click on Record button and check the Devices
    - Type: click
      Strategy: xpath
      Id: $PAGE.care_platform_participant_details.records_button$
    - Type: wait_for
      Strategy: xpath
      Id: $PAGE.providers_facilities_records_page.info_title$
    # Click to check Call History Tab
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_employees_page.employee_call_history_tab$
    - Type: sleep
      Time: 3
    # Click to open first option Accordion sub-tab for Call History
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_facilities_page.call_history_accordion$
    # Click on Telehealth request form
    - Type: click
      Strategy: xpath
      Id: $PAGE.providers_facilities_page.telehealth_request_form$
    - Type: sleep
      Time: 3